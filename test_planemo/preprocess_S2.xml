<tool id="SRS_preprocess_S2" name="Preprocessing sentinel 2 data" version="@VERSION@" profile = "20.01">
    <description>none</description>
    <requirements>
        <requirement type="package" version="2.11.0">r-R.utils</requirement>
        <requirement type="package" version="1.2.3">r-jqr</requirement>
        <requirement type="package" version="2.1.1">r-protolite</requirement>
        <requirement type="package" version="1.5.1">r-sen2r</requirement>
        <requirement type="package" version="3.5_15">r-raster</requirement>
        <requirement type="package" version="1.0_7">r-sf</requirement>
        <requirement type="package" version="1.4_7">r-sp</requirement>
        <requirement type="package" version="1.5_29">r-rgdal</requirement>
        <requirement type="package" version="0.5_9">r-rgeos</requirement>
        <requirement type="package" version="0.5_5">r-stars</requirement>
        <requirement type="package" version="1.4.0">r-stringr</requirement>
        <requirement type="package" version="1.2.2">r-progress</requirement>
        <requirement type="package" version="2.0.3">r-gdalutils</requirement>
        <requirement type="package" version="1.0.3">r-fasterize</requirement> 
        <requirement type="package" version="3.99_0.9">r-xml</requirement> 
        <requirement type="package" version="1.3.3">r-xml2</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        Rscript
            '$__tool_directory__/preprocess_S2.r'
            '$input'
            '$__tool_directory__/Lib_preprocess_S2.r'
            '$source_s2'
            '$id'
            '$pwd'
            '$output'
            '$output_refl'
            '$output_cloud'
        ]]>
    </command>
    <inputs>
        <param name="input" type="data" multiple="true" label="Input data"/>
        <param name="source_s2" type="select" label="Where does your data come from ?">
            <option value="SAFE">From Scihub</option>
            <option value="THEIA">From Theia</option>
            <option value="LaSRC">From Peps</option>
        </param> 
        <param name="id" type="text" label="Write down your Scihub identifier"/>
        <param name="pwd" type="text" label="Write down your Scihub password"/>      
    </inputs>
    <outputs>
        <data name="output" from_work_dir="truc.csv" format="csv" label="truc"/>
        <collection type="list" name="output_refl">
            <discover_datasets pattern="(?P&lt;designation&gt;.+)" directory="Reflectance" visible="false" format="binary,txt,xml"/>
        </collection>
        <collection type="list" name="output_cloud">
            <discover_datasets pattern="(?P&lt;designation&gt;.+)" directory="CloudMask" visible="false" format="raw,txt"/>
        </collection>
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help><![CDATA[
]]>    </help>

</tool>
